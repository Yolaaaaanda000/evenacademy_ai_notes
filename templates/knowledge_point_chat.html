<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Point Deep Dialogue</title>
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style_knowledge_point_chat.css') }}">
    <!-- MarkdownÊ∏≤ÊüìÂ∫ì -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/lib/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/github.min.css">
</head>
<body>
    <div class="knowledge-point-chat-container">
        <!-- Knowledge Point Information Card -->
        <div class="knowledge-point-card">
            <div class="card-header">
                <h2>üéØ Knowledge Point Deep Dialogue</h2>
                <button class="close-btn" onclick="closeKnowledgePointChat()">√ó</button>
            </div>
            <div class="card-content">
                <div class="knowledge-point-info">
                    <div class="info-row">
                        <span class="info-label">üìö Knowledge Point:</span>
                        <span class="info-value" id="knowledge-point-title">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">‚è∞ Timestamp:</span>
                        <span class="info-value" id="knowledge-point-timestamp">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">üìπ Video:</span>
                        <span class="info-value" id="video-title">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">üîó Related Concepts:</span>
                        <span class="info-value" id="related-concepts">-</span>
                    </div>
                </div>
                <div class="knowledge-point-content" id="knowledge-point-content">
                    <div class="content-text">Loading...</div>
                </div>
            </div>
        </div>

        <!-- Dialogue Area -->
        <div class="chat-section">
            <!-- Dialogue Status Bar -->
            <div class="chat-status-bar">
                <div class="status-indicators">
                    <div class="status-item">
                        <span class="status-label">Dialogue Rounds:</span>
                        <span class="status-value" id="dialogue-round">0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Focus Status:</span>
                        <span class="status-value" id="focus-status">Normal</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Understanding Progress:</span>
                        <div class="progress-bar">
                            <div class="progress-fill" id="understanding-progress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="action-btn" onclick="resetDialogue()">üîÑ Reset Dialogue</button>
                    <button class="action-btn" onclick="backToFocus()">üéØ Back to Focus</button>
                </div>
            </div>

            <!-- Dialogue Messages Area -->
            <div class="chat-messages" id="chat-messages">
                <div class="message ai-message">
                    <div class="message-content">
                        <div class="message-header">
                            <span class="ai-avatar">ü§ñ</span>
                            <span class="message-time" id="welcome-time"></span>
                        </div>
                        <div class="message-text">
                            Welcome to the Knowledge Point Deep Dialogue! I am your professional learning assistant.
                            <br><br>I can help you:
                            <br>‚Ä¢ üìñ Deeply understand the core concepts of this knowledge point
                            <br>‚Ä¢ üîç Analyze the principles and applications of the knowledge point
                            <br>‚Ä¢ üí° Provide related learning suggestions and thinking questions
                            <br>‚Ä¢ üéØ Ensure the dialogue always focuses on this knowledge point
                            <br><br>Please feel free to ask me questions, and I will provide you with professional answers!
                        </div>
                    </div>
                </div>
            </div>

            <!-- Suggested Questions Area -->
            <div class="suggested-questions" id="suggested-questions">
                <div class="suggestions-header">
                    <span>üí° Suggested Questions</span>
                    <button class="refresh-suggestions" onclick="refreshSuggestions()">üîÑ</button>
                </div>
                <div class="suggestions-list" id="suggestions-list">
                    <div class="suggestion-item" onclick="askSuggestion('What is the core concept of this knowledge point?')">
                        What is the core concept of this knowledge point?
                    </div>
                    <div class="suggestion-item" onclick="askSuggestion('How is this knowledge point applied in practice?')">
                        How is this knowledge point applied in practice?
                    </div>
                    <div class="suggestion-item" onclick="askSuggestion('What are the key formulas or principles involved?')">
                        What are the key formulas or principles involved?
                    </div>
                    <div class="suggestion-item" onclick="askSuggestion('Can you provide some examples to illustrate this concept?')">
                        Can you provide some examples to illustrate this concept?
                    </div>
                    <div class="suggestion-item" onclick="askSuggestion('What are the common misconceptions about this topic?')">
                        What are the common misconceptions about this topic?
                    </div>
                    <div class="suggestion-item" onclick="askSuggestion('How does this relate to other knowledge points?')">
                        How does this relate to other knowledge points?
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="chat-input-area">
                <textarea 
                    id="chat-input" 
                    placeholder="Ask me anything about this knowledge point..." 
                    rows="3"
                    maxlength="1000"
                ></textarea>
                <div class="input-actions">
                    <span class="char-count" id="char-count">0/1000</span>
                    <button id="send-btn" class="send-btn" onclick="sendMessage()" disabled>Send</button>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script_knowledge_point_chat.js') }}"></script>
</body>
</html> 